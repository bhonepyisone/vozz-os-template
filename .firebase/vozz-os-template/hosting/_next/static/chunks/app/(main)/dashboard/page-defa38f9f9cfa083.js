(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2248],{37090:function(e,t,a){Promise.resolve().then(a.bind(a,1785))},1785:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return L}});var s=a(57437),n=a(2265),r=a(8858),l=a(5978),c=a(58856),i=a(65696),o=a(86035),d=a(63070),m=a(27742),u=a(36502),x=a(85873),h=a(7641),f=a(97112),g=a(43949),p=a(70525),j=a(3085),y=a(21047);function b(e){let{title:t,value:a,icon:n,change:r,changeType:l,changeText:c}=e,i={increase:(0,s.jsx)(p.Z,{className:"w-4 h-4"}),decrease:(0,s.jsx)(j.Z,{className:"w-4 h-4"}),neutral:(0,s.jsx)(y.Z,{className:"w-4 h-4"})};return(0,s.jsxs)("div",{className:"bg-neo-bg p-6 rounded-2xl shadow-neo-md flex flex-col justify-between",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:t}),n]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-3xl font-bold text-gray-800 mt-2",children:a}),r&&(0,s.jsxs)("div",{className:"flex items-center text-sm mt-1 ".concat({increase:"text-green-600",decrease:"text-red-600",neutral:"text-gray-500"}[l]),children:[i[l],(0,s.jsxs)("span",{className:"ml-1",children:[r," ",c]})]})]})]})}var N=a(30166),v=a(51817),w=a(47625),S=a(56940),A=a(97059),I=a(62994),k=a(20039),O=a(67750),M=a(31699);let D=(0,N.default)(()=>Promise.all([a.e(7031),a.e(9986)]).then(a.bind(a,19986)).then(e=>e.BarChart),{loadableGenerated:{webpack:()=>[19986]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(v.Z,{className:"w-8 h-8 text-primary animate-spin"})})});function E(e){let{data:t}=e;return(0,s.jsx)(w.h,{width:"100%",height:"100%",children:(0,s.jsxs)(D,{data:t,margin:{top:5,right:20,left:-10,bottom:5},children:[(0,s.jsx)(S.q,{strokeDasharray:"3 3",stroke:"#e0e0e0"}),(0,s.jsx)(A.K,{dataKey:"name",tick:{fill:"#6b7280",fontSize:12}}),(0,s.jsx)(I.B,{tick:{fill:"#6b7280",fontSize:12}}),(0,s.jsx)(k.u,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(5px)",borderRadius:"0.5rem",border:"1px solid #e5e7eb"}}),(0,s.jsx)(O.D,{}),(0,s.jsx)(M.$,{dataKey:"Income",fill:"#6366F1",name:"Income",barSize:30})]})})}var Z=a(66474),B=a(56439);function C(){let{t:e}=(0,g.$G)("common"),[t,a]=(0,n.useState)([]),[c,i]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=(0,l.hJ)(r.db,"announcements"),t=(0,l.IO)(e,(0,l.ar)("expiresOn",">",l.EK.now()),(0,l.Xo)("expiresOn","asc"),(0,l.b9)(5)),s=(0,l.cf)(t,e=>{a(e.docs.map(e=>({id:e.id,...e.data(),createdAt:e.data().createdAt.toDate()}))),i(!1)},t=>{console.warn("Query with expiry date failed, using fallback. This is expected if you have old data without an expiry date.",t.message);let s=(0,l.IO)(e,(0,l.Xo)("createdAt","desc"),(0,l.b9)(5)),n=(0,l.cf)(s,e=>{a(e.docs.map(e=>({id:e.id,...e.data(),createdAt:e.data().createdAt.toDate()}))),i(!1)});return()=>n()});return()=>s()},[]),(0,s.jsxs)("div",{className:"space-y-4",children:[c&&(0,s.jsx)("p",{children:"Loading announcements..."}),!c&&0===t.length&&(0,s.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No announcements yet."}),t.map(t=>(0,s.jsxs)("div",{className:"p-4 bg-neo-bg rounded-lg shadow-neo-inset",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"font-bold text-gray-800 flex items-center",children:[(0,s.jsx)(B.Z,{className:"w-4 h-4 mr-2 text-primary"}),t.title]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:(0,Z.p)(t.createdAt)})]}),(0,s.jsx)("p",{className:"text-sm text-gray-700 mt-1 pl-6",children:t.content}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-2 text-right",children:[e("PostedBy"),": ",t.authorName]})]},t.id))]})}function U(){let[e,t]=(0,n.useState)([]),[a,c]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=(0,l.hJ)(r.db,"kudos"),a=(0,l.IO)(e,(0,l.Xo)("createdAt","desc"),(0,l.b9)(5)),s=(0,l.cf)(a,e=>{t(e.docs.map(e=>({id:e.id,...e.data()}))),c(!1)});return()=>s()},[]),(0,s.jsxs)("div",{className:"space-y-4",children:[a&&(0,s.jsx)("p",{children:"Loading kudos..."}),!a&&0===e.length&&(0,s.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No kudos given recently. Be the first!"}),e.map(e=>(0,s.jsxs)("div",{className:"p-4 bg-neo-bg rounded-lg shadow-neo-inset",children:[(0,s.jsxs)("div",{className:"flex items-center text-sm",children:[(0,s.jsx)("p",{className:"font-bold text-primary",children:e.fromName}),(0,s.jsx)("p",{className:"mx-2 text-gray-400",children:"â†’"}),(0,s.jsx)("p",{className:"font-bold text-primary",children:e.toName})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-700 mt-1 italic",children:['"',e.message,'"']})]},e.id))]})}var z=a(30387),P=a(95252),J=a(16275),W=a(95805);let K=["Daily","Weekly","Monthly","Yearly"];function L(){let{user:e}=(0,c.t)(),{t}=(0,g.$G)("common"),[a,j]=(0,n.useState)("Daily"),[y,N]=(0,n.useState)({income:0,orders:0,activeStaff:12,profitMargin:45.8}),[w,S]=(0,n.useState)([]),[A,I]=(0,n.useState)({bestStaff:"N/A",bestMenuItem:"N/A",mostActiveCustomer:"N/A"}),[k,O]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{let t,s;if(!(null==e?void 0:e.shopId)){O(!1);return}O(!0);let n=new Date;switch(a){case"Weekly":t=(0,i.z)(n,{weekStartsOn:1}),s=(0,o.v)(n,{weekStartsOn:1});break;case"Monthly":t=(0,d.N)(n),s=(0,m.V)(n);break;case"Yearly":t=(0,u.e)(n),s=(0,x.w)(n);break;default:(t=new Date).setHours(0,0,0,0),s=(0,h.i)(n)}let c=l.EK.fromDate(t),g=l.EK.fromDate(s);try{let t=(0,l.hJ)(r.db,"sales"),s=(0,l.IO)(t,(0,l.ar)("shopId","==",e.shopId),(0,l.ar)("createdAt",">=",c),(0,l.ar)("createdAt","<=",g)),n=(await (0,l.PL)(s)).docs.map(e=>e.data()),i=0,o=0,d={},m={},u={};n.forEach(e=>{i+=e.totalAmount,o+=1,e.createdBy&&(d[e.createdBy]=(d[e.createdBy]||0)+e.totalAmount),e.items&&Array.isArray(e.items)&&e.items.forEach(e=>{m[e.name]=(m[e.name]||0)+e.quantity}),e.customerId&&(u[e.customerId]=(u[e.customerId]||0)+e.totalAmount)});let x=Object.keys(d).reduce((e,t)=>d[e]>d[t]?e:t,null),h=Object.keys(m).reduce((e,t)=>m[e]>m[t]?e:t,"N/A"),p=Object.keys(u).reduce((e,t)=>u[e]>u[t]?e:t,null),j="N/A";if(x){let e=await (0,l.QT)((0,l.JU)(r.db,"users",x));e.exists()&&(j=e.data().name)}let y="N/A";if(p){let e=await (0,l.QT)((0,l.JU)(r.db,"customers",p));e.exists()&&(y=e.data().name)}I({bestStaff:j,bestMenuItem:h,mostActiveCustomer:y});let b=n.map(e=>({amount:e.totalAmount,date:e.createdAt.toDate()})),v=[];if("Daily"===a){let e=Array(24).fill(0);b.forEach(t=>{let a=t.date.getHours();e[a]+=t.amount}),v=e.map((e,t)=>({name:"".concat(t,":00"),Income:e}))}else if("Weekly"===a){let e={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0,Sat:0,Sun:0};b.forEach(t=>{let a=(0,f.WU)(t.date,"E");e[a]+=t.amount}),v=Object.entries(e).map(e=>{let[t,a]=e;return{name:t,Income:a}})}else if("Monthly"===a){let e={};b.forEach(t=>{let a=(0,f.WU)(t.date,"d");e[a]=(e[a]||0)+t.amount}),v=Object.entries(e).map(e=>{let[t,a]=e;return{name:"Day ".concat(t),Income:a}})}else if("Yearly"===a){let e={Jan:0,Feb:0,Mar:0,Apr:0,May:0,Jun:0,Jul:0,Aug:0,Sep:0,Oct:0,Nov:0,Dec:0};b.forEach(t=>{let a=(0,f.WU)(t.date,"MMM");e[a]+=t.amount}),v=Object.entries(e).map(e=>{let[t,a]=e;return{name:t,Income:a}})}S(v),N(e=>({...e,income:i,orders:o}))}catch(e){console.error("Error fetching dashboard data:",e)}finally{O(!1)}})()},[e,a]);let M=[{title:t("".concat(a,"Income")),value:y.income.toLocaleString(),icon:(0,s.jsx)(P.Z,{className:"w-6 h-6 text-green-500"})},{title:t("".concat(a,"Orders")),value:y.orders.toLocaleString(),icon:(0,s.jsx)(J.Z,{className:"w-6 h-6 text-blue-500"})},{title:t("ActiveStaff"),value:y.activeStaff.toLocaleString(),icon:(0,s.jsx)(W.Z,{className:"w-6 h-6 text-yellow-500"})},{title:t("ProfitMargin"),value:"".concat(y.profitMargin,"%"),icon:(0,s.jsx)(p.Z,{className:"w-6 h-6 text-purple-500"})}];return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-700",style:{textShadow:"1px 1px 1px #ffffff"},children:t("ShopDashboard")}),(0,s.jsx)("div",{className:"flex items-center bg-neo-bg p-1 rounded-lg shadow-neo-inset-active",children:K.map(e=>(0,s.jsx)("button",{onClick:()=>j(e),className:"px-4 py-1.5 text-sm font-semibold rounded-md transition-colors ".concat(a===e?"bg-neo-bg shadow-neo-md text-primary":"text-gray-600"),children:t(e)},e))})]}),k?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)(v.Z,{className:"w-12 h-12 text-primary animate-spin"})}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:M.map((e,t)=>(0,s.jsx)(b,{title:e.title,value:e.value,icon:e.icon},t))}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsx)(z.Z,{title:"".concat(t(a)," ").concat(t("Performance")),className:"lg:col-span-2",children:(0,s.jsx)("div",{style:{height:"300px"},children:(0,s.jsx)(E,{data:w})})}),(0,s.jsx)(z.Z,{title:t("TopPerformers"),children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:t("BestStaff")}),(0,s.jsx)("p",{className:"text-lg font-bold text-gray-800",children:A.bestStaff})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:t("BestSellingMenu")}),(0,s.jsx)("p",{className:"text-lg font-bold text-gray-800",children:A.bestMenuItem})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:t("MostActiveCustomer")}),(0,s.jsx)("p",{className:"text-lg font-bold text-gray-800",children:A.mostActiveCustomer})]})]})})]}),(0,s.jsx)(z.Z,{title:t("RecentAnnouncements"),children:(0,s.jsx)(C,{})}),(0,s.jsx)(z.Z,{title:t("RecentKudos"),children:(0,s.jsx)(U,{})})]})]})}},30387:function(e,t,a){"use strict";var s=a(57437);t.Z=e=>{let{children:t,title:a,className:n="",...r}=e;return(0,s.jsxs)("div",{className:"bg-neo-bg p-6 rounded-2xl shadow-neo-lg ".concat(n),...r,children:[a&&(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-4 border-b border-neo-dark/50 pb-2",children:a}),(0,s.jsx)("div",{className:"text-gray-600",children:t})]})}},58856:function(e,t,a){"use strict";a.d(t,{t:function(){return c}});var s=a(59625),n=a(8858),r=a(5978),l=a(43301);let c=(0,s.Ue)(e=>({user:null,loading:!0,fetchUser:()=>{(0,l.Aj)(n.I8,async t=>{if(t){let a=(0,r.JU)(n.db,"users",t.uid),s=await (0,r.QT)(a);s.exists()?e({user:{uid:s.id,...s.data()},loading:!1}):((0,l.w7)(n.I8),e({user:null,loading:!1}))}else e({user:null,loading:!1})})},login:async(t,a,s)=>{e({loading:!0});try{let e=s?l.a$:l.aT;await (0,l.Fb)(n.I8,e),await (0,l.e5)(n.I8,t,a)}catch(t){throw console.error("Login failed:",t),e({user:null,loading:!1}),t}},logout:async()=>{e({loading:!0}),await (0,l.w7)(n.I8)}}));c.getState().fetchUser()},8858:function(e,t,a){"use strict";let s;a.d(t,{I8:function(){return i},db:function(){return o}});var n=a(738),r=a(43301),l=a(5978),c=a(13491);s=(0,n.C6)().length?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"AIzaSyBc-lay18YWj7GGVQsMpeGOQ6FG2Bjv4Ug",authDomain:"vozz-os-template.firebaseapp.com",projectId:"vozz-os-template",storageBucket:"vozz-os-template.firebasestorage.app",messagingSenderId:"790770638358",appId:"1:790770638358:web:cb155fd1022b9d6eb39f37"});let i=(0,r.v0)(s),o=(0,l.ad)(s);(0,c.$C)(s)},66474:function(e,t,a){"use strict";a.d(t,{p:function(){return n},x:function(){return r}});var s=a(97112);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PPP";return e?(0,s.WU)(new Date(e),t):""}function r(e){return"number"!=typeof e?"":e.toLocaleString("en-US")}}},function(e){e.O(0,[4358,9990,294,3949,7112,4732,1534,2971,2117,1744],function(){return e(e.s=37090)}),_N_E=e.O()}]);