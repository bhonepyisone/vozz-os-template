(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9228],{39310:function(e,t,n){Promise.resolve().then(n.bind(n,65293))},65293:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var s=n(57437),a=n(58856),r=n(43949),l=n(2265),o=n(35398),i=n(30387);function d(){let{t:e}=(0,r.$G)("common"),{user:t}=(0,a.t)(),[n,d]=(0,l.useState)("");return((0,l.useEffect)(()=>{if(!t)return;let e=()=>{let e=Date.now();d(JSON.stringify({staffId:t.uid,name:t.name,position:t.role,timestamp:e}))};e();let n=setInterval(e,6e4);return()=>clearInterval(n)},[t]),t)?(0,s.jsx)(i.Z,{title:e("YourAttendanceQRCode"),children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[n?(0,s.jsx)("div",{className:"p-4 bg-neo-bg rounded-lg shadow-neo-inset",children:(0,s.jsx)(o.ZP,{value:n,size:256,level:"H",includeMargin:!0,bgColor:"#e0e5ec",fgColor:"#333333"})}):(0,s.jsx)("div",{className:"w-64 h-64 bg-neo-bg shadow-neo-inset rounded-lg animate-pulse"}),(0,s.jsx)("p",{className:"mt-4 text-sm text-gray-600",children:e("ShowThisToFrontDesk")}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e("CodeRefreshesEvery60Seconds")})]})}):(0,s.jsx)(i.Z,{title:"QR Code",children:(0,s.jsx)("p",{children:"Please log in to see your QR code."})})}var c=n(8858),u=n(5978),m=n(791);function x(){let{t:e}=(0,r.$G)("common"),[t,n]=(0,l.useState)(null),[a,o]=(0,l.useState)("");return(0,l.useEffect)(()=>{let e=new m.wF("reader",{qrbox:{width:250,height:250},fps:5},!1),t=!0,s=async(s,a)=>{if(t){t=!1,e.clear();try{let e=JSON.parse(s);if(e.staffId&&e.name&&e.position)n("Success! Clocked in: ".concat(e.name," (").concat(e.position,")")),o(""),await (0,u.ET)((0,u.hJ)(c.db,"attendance"),{staffId:e.staffId,staffName:e.name,position:e.position,scannedAt:u.EK.now(),type:"Clock-In/Out"});else throw Error("Invalid QR code format.")}catch(e){console.error("Error processing QR code:",e),o("Failed to process an invalid QR code."),n(null)}}};return e.render(s,e=>{}),()=>{e&&e.clear().catch(e=>{console.error("Failed to clear html5-qrcode scanner.",e)})}},[]),(0,s.jsxs)(i.Z,{title:e("ScanStaffQRCode"),children:[(0,s.jsx)("div",{id:"reader",className:"w-full"}),t&&(0,s.jsx)("div",{className:"mt-4 p-3 text-sm rounded-lg bg-green-100 text-green-800",children:t}),a&&(0,s.jsx)("div",{className:"mt-4 p-3 text-sm rounded-lg bg-red-100 text-red-800",children:a})]})}var f=n(44743),h=n(63295),g=n(11511),p=n(57598);function v(e){let{onSuccess:t}=e,{t:n}=(0,r.$G)("common"),{user:o}=(0,a.t)(),[d,m]=(0,l.useState)("Annual Leave"),[x,v]=(0,l.useState)(""),[b,j]=(0,l.useState)(""),[y,w]=(0,l.useState)(""),[N,S]=(0,l.useState)(!1),I=async e=>{if(e.preventDefault(),o&&x&&b){S(!0);try{await (0,u.ET)((0,u.hJ)(c.db,"leave_requests"),{staffId:o.uid,staffName:o.name,leaveType:d,startDate:u.EK.fromDate(new Date(x)),endDate:u.EK.fromDate(new Date(b)),reason:y,status:"pending",requestedAt:u.EK.now()}),t("Leave request submitted successfully!"),m("Annual Leave"),v(""),j(""),w("")}catch(e){console.error("Error submitting leave request:",e)}finally{S(!1)}}};return(0,s.jsx)(i.Z,{title:n("SubmitLeaveRequest"),children:(0,s.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"leaveType",className:"block text-sm font-medium text-gray-700 mb-1",children:n("LeaveType")}),(0,s.jsxs)(g.Z,{id:"leaveType",value:d,onChange:e=>m(e.target.value),children:[(0,s.jsx)("option",{children:n("AnnualLeave")}),(0,s.jsx)("option",{children:n("SickLeave")}),(0,s.jsx)("option",{children:n("UnpaidLeave")}),(0,s.jsx)("option",{children:n("Other")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:n("StartDate")}),(0,s.jsx)(h.Z,{type:"date",id:"startDate",value:x,onChange:e=>v(e.target.value),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:n("EndDate")}),(0,s.jsx)(h.Z,{type:"date",id:"endDate",value:b,onChange:e=>j(e.target.value),required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:n("ReasonOptional")}),(0,s.jsx)(e=>(0,s.jsx)("textarea",{...e,className:"w-full my-1 p-3 bg-neo-bg rounded-lg shadow-neo-inset focus:outline-none text-sm"}),{id:"reason",value:y,onChange:e=>w(e.target.value),rows:"3"})]}),(0,s.jsxs)(p.Z,{type:"submit",disabled:N,children:[(0,s.jsx)(f.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:n(N?"Submitting":"SubmitRequest")})]})]})})}function b(){let{t:e}=(0,r.$G)("common"),{user:t}=(0,a.t)(),n=(null==t?void 0:t.role)==="Admin"||(null==t?void 0:t.role)==="Front Desk";return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-700 mb-6",style:{textShadow:"1px 1px 1px #ffffff"},children:e("Attendance")}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsx)("div",{children:n?(0,s.jsx)(x,{}):(0,s.jsx)(d,{})}),(0,s.jsx)("div",{children:(0,s.jsx)(v,{})})]})]})}},30387:function(e,t,n){"use strict";var s=n(57437);t.Z=e=>{let{children:t,title:n,className:a="",...r}=e;return(0,s.jsxs)("div",{className:"bg-neo-bg p-6 rounded-2xl shadow-neo-lg ".concat(a),...r,children:[n&&(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-4 border-b border-neo-dark/50 pb-2",children:n}),(0,s.jsx)("div",{className:"text-gray-600",children:t})]})}},57598:function(e,t,n){"use strict";var s=n(57437);t.Z=e=>{let{children:t,className:n="",...a}=e;return(0,s.jsx)("button",{...a,className:"w-full p-3 bg-neo-bg rounded-lg font-bold text-gray-700 shadow-neo-md transition-all hover:text-primary active:shadow-neo-inset disabled:opacity-50 flex items-center justify-center space-x-2 ".concat(n),children:t})}},63295:function(e,t,n){"use strict";var s=n(57437);t.Z=e=>{let{className:t="",...n}=e;return(0,s.jsx)("input",{...n,className:"w-full my-1 p-3 bg-neo-bg rounded-lg shadow-neo-inset focus:outline-none text-sm ".concat(t)})}},11511:function(e,t,n){"use strict";var s=n(57437);t.Z=e=>{let{children:t,className:n="",...a}=e;return(0,s.jsx)("select",{...a,className:"w-full my-1 p-3 bg-neo-bg rounded-lg shadow-neo-inset focus:outline-none appearance-none text-sm ".concat(n),children:t})}},58856:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var s=n(59625),a=n(8858),r=n(5978),l=n(43301);let o=(0,s.Ue)(e=>({user:null,loading:!0,fetchUser:()=>{(0,l.Aj)(a.I8,async t=>{if(t){let n=(0,r.JU)(a.db,"users",t.uid),s=await (0,r.QT)(n);s.exists()?e({user:{uid:s.id,...s.data()},loading:!1}):((0,l.w7)(a.I8),e({user:null,loading:!1}))}else e({user:null,loading:!1})})},login:async(t,n,s)=>{e({loading:!0});try{let e=s?l.a$:l.aT;await (0,l.Fb)(a.I8,e),await (0,l.e5)(a.I8,t,n)}catch(t){throw console.error("Login failed:",t),e({user:null,loading:!1}),t}},logout:async()=>{e({loading:!0}),await (0,l.w7)(a.I8)}}));o.getState().fetchUser()},8858:function(e,t,n){"use strict";let s;n.d(t,{I8:function(){return i},db:function(){return d}});var a=n(738),r=n(43301),l=n(5978),o=n(13491);s=(0,a.C6)().length?(0,a.C6)()[0]:(0,a.ZF)({apiKey:"AIzaSyBc-lay18YWj7GGVQsMpeGOQ6FG2Bjv4Ug",authDomain:"vozz-os-template.firebaseapp.com",projectId:"vozz-os-template",storageBucket:"vozz-os-template.firebasestorage.app",messagingSenderId:"790770638358",appId:"1:790770638358:web:cb155fd1022b9d6eb39f37"});let i=(0,r.v0)(s),d=(0,l.ad)(s);(0,o.$C)(s)}},function(e){e.O(0,[4358,9990,52,294,3949,7727,2971,2117,1744],function(){return e(e.s=39310)}),_N_E=e.O()}]);