(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2367],{3025:function(e,t,s){Promise.resolve().then(s.bind(s,14072))},51817:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},14072:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var a=s(57437),n=s(2265),r=s(8858),l=s(5978),i=s(26937),o=s(66474),c=s(65696),d=s(86035),x=s(63070),m=s(27742),u=s(36502),p=s(85873),h=s(7641),f=s(30387),b=s(63295),y=s(11511),g=s(57598),j=s(40673);let N=["Daily","Weekly","Monthly","Yearly"];function v(){let[e,t]=(0,n.useState)([]),[s,v]=(0,n.useState)(!0),[w,k]=(0,n.useState)("Daily"),[S,P]=(0,n.useState)(0),[C,E]=(0,n.useState)(""),[Z,D]=(0,n.useState)("COGS"),[O,A]=(0,n.useState)(""),[G,L]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e,s;v(!0);let a=new Date;switch(w){case"Weekly":e=(0,c.z)(a,{weekStartsOn:1}),s=(0,d.v)(a,{weekStartsOn:1});break;case"Monthly":e=(0,x.N)(a),s=(0,m.V)(a);break;case"Yearly":e=(0,u.e)(a),s=(0,p.w)(a);break;default:(e=new Date).setHours(0,0,0,0),s=(0,h.i)(a)}let n=l.EK.fromDate(e),i=l.EK.fromDate(s),f=(0,l.IO)((0,l.hJ)(r.db,"expenses"),(0,l.ar)("date",">=",n),(0,l.ar)("date","<=",i),(0,l.Xo)("date","desc")),b=(0,l.cf)(f,e=>{let s=e.docs.map(e=>({id:e.id,...e.data(),date:e.data().date?(0,o.p)(e.data().date.toDate(),"PP"):"N/A"}));t(s),P(s.reduce((e,t)=>e+t.amount,0)),v(!1)});return()=>b()},[w]);let T=async e=>{if(e.preventDefault(),C&&O){L(!0);try{await (0,l.ET)((0,l.hJ)(r.db,"expenses"),{description:C,category:Z,amount:Number(O),date:l.EK.now()}),E(""),D("COGS"),A("")}catch(e){console.error("Error adding expense:",e),alert("Failed to add expense.")}finally{L(!1)}}};return(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)(f.Z,{title:"Add New Expense",className:"lg:col-span-1",children:(0,a.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)(b.Z,{type:"text",id:"description",value:C,onChange:e=>E(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,a.jsxs)(y.Z,{id:"category",value:Z,onChange:e=>D(e.target.value),children:[(0,a.jsx)("option",{children:"COGS"}),(0,a.jsx)("option",{children:"Labor"}),(0,a.jsx)("option",{children:"Rent"}),(0,a.jsx)("option",{children:"Utilities"}),(0,a.jsx)("option",{children:"Marketing"}),(0,a.jsx)("option",{children:"Other"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),(0,a.jsx)(b.Z,{type:"number",id:"amount",value:O,onChange:e=>A(e.target.value),required:!0})]}),(0,a.jsxs)(g.Z,{type:"submit",disabled:G,children:[(0,a.jsx)(i.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:G?"Adding...":"Add Expense"})]})]})}),(0,a.jsxs)(f.Z,{className:"lg:col-span-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Expenses Record"}),(0,a.jsx)("div",{className:"flex items-center bg-neo-bg p-1 rounded-lg shadow-neo-inset-active",children:N.map(e=>(0,a.jsx)("button",{onClick:()=>k(e),className:"px-3 py-1 text-sm font-semibold rounded-md transition-colors ".concat(w===e?"bg-neo-bg shadow-neo-md text-primary":"text-gray-600"),children:e},e))})]}),(0,a.jsxs)("div",{className:"mb-4 pt-4 border-t border-b border-neo-dark/20",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-md font-semibold text-gray-700",children:"Total for Period"}),(0,a.jsx)(j.Z,{data:e,headers:[{label:"Date",key:"date"},{label:"Description",key:"description"},{label:"Category",key:"category"},{label:"Amount",key:"amount"}],filename:"expenses_".concat(w,".csv")})]}),(0,a.jsx)("div",{className:"text-center mt-2",children:(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:S.toLocaleString(void 0,{minimumFractionDigits:2})})})]}),(0,a.jsx)("div",{className:"overflow-x-auto max-h-96",children:s?(0,a.jsx)("p",{children:"Loading expenses..."}):(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Date"}),(0,a.jsx)("th",{className:"py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Description"}),(0,a.jsx)("th",{className:"py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Category"}),(0,a.jsx)("th",{className:"py-3 text-right text-xs font-semibold text-gray-500 uppercase",children:"Amount"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{className:"border-t border-neo-dark/20",children:[(0,a.jsx)("td",{className:"py-4 whitespace-nowrap text-sm text-gray-500",children:e.date}),(0,a.jsx)("td",{className:"py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.description}),(0,a.jsx)("td",{className:"py-4 whitespace-nowrap text-sm text-gray-500",children:e.category}),(0,a.jsx)("td",{className:"py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:e.amount.toLocaleString()})]},e.id))})]})})]})]})}var w=s(43949),k=s(97112),S=s(73618),P=s(51817);function C(){let{t:e}=(0,w.$G)("common"),[t,s]=(0,n.useState)((0,k.WU)(new Date,"yyyy-MM-dd")),[i,o]=(0,n.useState)((0,k.WU)(new Date,"yyyy-MM-dd")),[c,d]=(0,n.useState)(7),[x,m]=(0,n.useState)(null),[u,p]=(0,n.useState)(!1),h=async()=>{p(!0),m(null);try{let e=new Date(t),s=new Date(i);s.setHours(23,59,59,999);let a=l.EK.fromDate(e),n=l.EK.fromDate(s),o=(0,l.IO)((0,l.hJ)(r.db,"sales"),(0,l.ar)("createdAt",">=",a),(0,l.ar)("createdAt","<=",n)),d=(await (0,l.PL)(o)).docs.reduce((e,t)=>e+(t.data().totalAmount||0),0),x=(0,l.IO)((0,l.hJ)(r.db,"expenses"),(0,l.ar)("date",">=",a),(0,l.ar)("date","<=",n)),u=await (0,l.PL)(x),p=0,h={};u.docs.forEach(e=>{let t=e.data(),s=t.amount||0;"COGS"===t.category?p+=s:h[t.category]=(h[t.category]||0)+s});let f=Object.values(h).reduce((e,t)=>e+t,0),b=d-p,y=b-f,g=y>0?c/100*y:0;m({period:"".concat((0,k.WU)(e,"PPP")," - ").concat((0,k.WU)(s,"PPP")),revenue:d,cogs:p,operatingExpenses:h,totalOperatingExpenses:f,grossProfit:b,profitBeforeTax:y,taxPercent:c,taxAmount:g,netProfit:y-g})}catch(e){console.error("Error generating P&L Statement:",e),alert("Failed to generate statement. Check console for errors.")}finally{p(!1)}},y=e=>e.toLocaleString(void 0,{minimumFractionDigits:2}),N=x?[{item:"Total Revenue",amount:x.revenue},{item:"Cost of Goods Sold (COGS)",amount:-x.cogs},{item:"Gross Profit",amount:x.grossProfit},...Object.entries(x.operatingExpenses).map(e=>{let[t,s]=e;return{item:"Expense: ".concat(t),amount:-s}}),{item:"Total Operating Expenses",amount:-x.totalOperatingExpenses},{item:"Profit Before Tax",amount:x.profitBeforeTax},{item:"Tax (".concat(x.taxPercent,"%)"),amount:-x.taxAmount},{item:"Net Profit",amount:x.netProfit}]:[];return(0,a.jsxs)(f.Z,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:e("ProfitAndLossStatement")}),x&&(0,a.jsx)(j.Z,{data:N,headers:[{label:"Line Item",key:"item"},{label:"Amount",key:"amount"}],filename:"profit_and_loss_statement.csv"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 p-4 border border-neo-dark/20 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e("StartDate")}),(0,a.jsx)(b.Z,{type:"date",value:t,onChange:e=>s(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e("EndDate")}),(0,a.jsx)(b.Z,{type:"date",value:i,onChange:e=>o(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e("Tax")," (%)"]}),(0,a.jsx)(b.Z,{type:"number",value:c,onChange:e=>d(parseFloat(e.target.value)||0),placeholder:"e.g. 7"})]}),(0,a.jsx)("div",{className:"self-end",children:(0,a.jsxs)(g.Z,{onClick:h,disabled:u,children:[(0,a.jsx)(S.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:u?e("Generating"):e("Generate")})]})})]}),u&&(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(P.Z,{className:"w-8 h-8 text-primary animate-spin"})}),x&&(0,a.jsxs)("div",{className:"space-y-4 mt-6",children:[(0,a.jsx)("p",{className:"text-center font-semibold text-gray-800",children:x.period}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-neo-dark/20",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-700",children:e("TotalRevenue")}),(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:y(x.revenue)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:e("COGS")}),(0,a.jsxs)("span",{className:"text-gray-600",children:["(",y(x.cogs),")"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-t border-b border-neo-dark/20 font-bold",children:[(0,a.jsx)("span",{className:"text-gray-800",children:e("GrossProfit")}),(0,a.jsx)("span",{className:"text-gray-900",children:y(x.grossProfit)})]}),(0,a.jsxs)("div",{className:"pt-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-700 mb-2",children:e("OperatingExpenses")}),(0,a.jsxs)("div",{className:"pl-4 space-y-2 text-sm",children:[Object.entries(x.operatingExpenses).map(t=>{let[s,n]=t;return(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600 capitalize",children:e(s)}),(0,a.jsxs)("span",{className:"text-gray-600",children:["(",y(n),")"]})]},s)}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold border-t border-neo-dark/20 pt-2 mt-2",children:[(0,a.jsx)("span",{className:"text-gray-700",children:e("TotalOperatingExpenses")}),(0,a.jsxs)("span",{className:"text-gray-700",children:["(",y(x.totalOperatingExpenses),")"]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-t border-neo-dark/20 mt-4",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-700",children:e("ProfitBeforeTax")}),(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:y(x.profitBeforeTax)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,a.jsxs)("span",{className:"text-gray-600",children:[e("Tax")," (",x.taxPercent,"%)"]}),(0,a.jsxs)("span",{className:"text-gray-600",children:["(",y(x.taxAmount),")"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-3 border-t-2 border-b-2 border-gray-900/50 mt-2",children:[(0,a.jsx)("span",{className:"text-xl font-bold text-gray-900",children:e("NetProfit")}),(0,a.jsx)("span",{className:"text-xl font-bold ".concat(x.netProfit>=0?"text-green-600":"text-red-600"),children:y(x.netProfit)})]})]})]})}function E(){return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Financial Management"}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(v,{}),(0,a.jsx)(C,{})]})]})}},30387:function(e,t,s){"use strict";var a=s(57437);t.Z=e=>{let{children:t,title:s,className:n="",...r}=e;return(0,a.jsxs)("div",{className:"bg-neo-bg p-6 rounded-2xl shadow-neo-lg ".concat(n),...r,children:[s&&(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-4 border-b border-neo-dark/50 pb-2",children:s}),(0,a.jsx)("div",{className:"text-gray-600",children:t})]})}},40673:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(57437),n=s(53359),r=s(57598),l=s(92735);function i(e){let{data:t,filename:s,headers:i}=e,o=Array.isArray(t)?t:[];return(0,a.jsx)(n.CSVLink,{data:o,headers:i,filename:s,className:"no-underline",target:"_blank",children:(0,a.jsxs)(r.Z,{className:"!w-auto !px-4 !py-2 !text-xs",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"Export to CSV"]})})}},57598:function(e,t,s){"use strict";var a=s(57437);t.Z=e=>{let{children:t,className:s="",...n}=e;return(0,a.jsx)("button",{...n,className:"w-full p-3 bg-neo-bg rounded-lg font-bold text-gray-700 shadow-neo-md transition-all hover:text-primary active:shadow-neo-inset disabled:opacity-50 flex items-center justify-center space-x-2 ".concat(s),children:t})}},63295:function(e,t,s){"use strict";var a=s(57437);t.Z=e=>{let{className:t="",...s}=e;return(0,a.jsx)("input",{...s,className:"w-full my-1 p-3 bg-neo-bg rounded-lg shadow-neo-inset focus:outline-none text-sm ".concat(t)})}},11511:function(e,t,s){"use strict";var a=s(57437);t.Z=e=>{let{children:t,className:s="",...n}=e;return(0,a.jsx)("select",{...n,className:"w-full my-1 p-3 bg-neo-bg rounded-lg shadow-neo-inset focus:outline-none appearance-none text-sm ".concat(s),children:t})}},8858:function(e,t,s){"use strict";let a;s.d(t,{I8:function(){return o},db:function(){return c}});var n=s(738),r=s(43301),l=s(5978),i=s(13491);a=(0,n.C6)().length?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"AIzaSyBc-lay18YWj7GGVQsMpeGOQ6FG2Bjv4Ug",authDomain:"vozz-os-template.firebaseapp.com",projectId:"vozz-os-template",storageBucket:"vozz-os-template.firebasestorage.app",messagingSenderId:"790770638358",appId:"1:790770638358:web:cb155fd1022b9d6eb39f37"});let o=(0,r.v0)(a),c=(0,l.ad)(a);(0,i.$C)(a)},66474:function(e,t,s){"use strict";s.d(t,{p:function(){return n},x:function(){return r}});var a=s(97112);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PPP";return e?(0,a.WU)(new Date(e),t):""}function r(e){return"number"!=typeof e?"":e.toLocaleString("en-US")}}},function(e){e.O(0,[4358,9990,294,3949,7112,2085,2971,2117,1744],function(){return e(e.s=3025)}),_N_E=e.O()}]);